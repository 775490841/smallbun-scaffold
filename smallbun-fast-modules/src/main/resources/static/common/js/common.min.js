var App=function(){var basePath="./";var imgPath="common/img/";var pluginsPath="common/plugins/";var cssPath="common/css/";var handleIframeLayoutHeight=function(){var height=App.getViewPort().height-$(".main-footer").outerHeight()-$(".main-header").outerHeight()-$(".content-tabs").outerHeight();return height};var handleIframeLayoutContent=function(){var height=App.getViewPort().height-$(".main-footer").outerHeight()-$(".main-header").outerHeight()-$(".content-tabs").outerHeight();$(".content-iframe").css({height:height});$(".tab_iframe").css({height:height});$(".tab_iframe").css({width:"100%"})};var handleFullScreen=function(){var docElm=document.documentElement;if(docElm.requestFullscreen){docElm.requestFullscreen()}else{if(docElm.mozRequestFullScreen){docElm.mozRequestFullScreen()}else{if(docElm.webkitRequestFullScreen){docElm.webkitRequestFullScreen()}else{if(elem.msRequestFullscreen){elem.msRequestFullscreen()}}}}};var exitFullscreen=function(){if(document.exitFullscreen){document.exitFullscreen()}else{if(document.mozCancelFullScreen){document.mozCancelFullScreen()}else{if(document.webkitCancelFullScreen){document.webkitCancelFullScreen()}else{if(document.msExitFullscreen){document.msExitFullscreen()}}}}};var handleiCheck=function(){if(!$().iCheck){return}$(".icheck").each(function(){var checkboxClass=$(this).attr("data-checkbox")?$(this).attr("data-checkbox"):"icheckbox_minimal-grey";var radioClass=$(this).attr("data-radio")?$(this).attr("data-radio"):"iradio_minimal-grey";if(checkboxClass.indexOf("_line")>-1||radioClass.indexOf("_line")>-1){$(this).iCheck({checkboxClass:checkboxClass,radioClass:radioClass,insert:'<div class="icheck_line-icon"></div>'+$(this).attr("data-label")})}else{$(this).iCheck({checkboxClass:checkboxClass,radioClass:radioClass})}})};var handleBootstrapSwitch=function(){if(!$().bootstrapSwitch){return}$(".make-switch").bootstrapSwitch()};var handleBootstrapConfirmation=function(){if(!$().confirmation){return}$("[data-toggle=confirmation]").confirmation({container:"body",btnOkClass:"btn btn-sm btn-success",btnCancelClass:"btn btn-sm btn-danger"})};var handleAccordions=function(){$("body").on("shown.bs.collapse",".accordion.scrollable",function(e){App.scrollTo($(e.target))})};var handleTabs=function(){if(location.hash){var tabId=encodeURI(location.hash.substr(1));$('a[href="#'+tabId+'"]').parents(".tab-pane:hidden").each(function(){var tabId=$(this).attr("id");$('a[href="#'+tabId+'"]').click()});$('a[href="#'+tabId+'"]').click()}if($().tabdrop){$(".tabbable-tabdrop .nav-pills, .tabbable-tabdrop .nav-tabs").tabdrop({text:'<i class="fa fa-ellipsis-v"></i>&nbsp;<i class="fa fa-angle-down"></i>'})}};var handleModals=function(){$("body").on("hide.bs.modal",function(){if($(".modal:visible").size()>1&&$("html").hasClass("modal-open")===false){$("html").addClass("modal-open")}else{if($(".modal:visible").size()<=1){$("html").removeClass("modal-open")}}});$("body").on("show.bs.modal",".modal",function(){if($(this).hasClass("modal-scroll")){$("body").addClass("modal-open-noscroll")}});$("body").on("hide.bs.modal",".modal",function(){$("body").removeClass("modal-open-noscroll")});$("body").on("hidden.bs.modal",".modal:not(.modal-cached)",function(){$(this).removeData("bs.modal")})};var handleTooltips=function(){$(".tooltips").tooltip();$(".portlet > .portlet-title .fullscreen").tooltip({container:"body",title:"Fullscreen"});$(".portlet > .portlet-title > .tools > .reload").tooltip({container:"body",title:"Reload"});$(".portlet > .portlet-title > .tools > .remove").tooltip({container:"body",title:"Remove"});$(".portlet > .portlet-title > .tools > .config").tooltip({container:"body",title:"Settings"});$(".portlet > .portlet-title > .tools > .collapse, .portlet > .portlet-title > .tools > .expand").tooltip({container:"body",title:"Collapse/Expand"})};var handleDropdowns=function(){$("body").on("click",".dropdown-menu.hold-on-click",function(e){e.stopPropagation()})};var handleAlerts=function(){$("body").on("click",'[data-close="alert"]',function(e){$(this).parent(".alert").hide();$(this).closest(".note").hide();e.preventDefault()});$("body").on("click",'[data-close="note"]',function(e){$(this).closest(".note").hide();e.preventDefault()});$("body").on("click",'[data-remove="note"]',function(e){$(this).closest(".note").remove();e.preventDefault()})};var handleDropdownHover=function(){$('[data-hover="dropdown"]').not(".hover-initialized").each(function(){$(this).dropdownHover();$(this).addClass("hover-initialized")})};var handleFixInputPlaceholderForIE=function(){var isIe8=!!navigator.userAgent.match(/MSIE 8.0/);var isIe9=!!navigator.userAgent.match(/MSIE 9.0/);var isIe10=!!navigator.userAgent.match(/MSIE 10.0/);if(isIe8||isIe9){$("input[placeholder]:not(.placeholder-no-fix), textarea[placeholder]:not(.placeholder-no-fix)").each(function(){var input=$(this);if(input.val()===""&&input.attr("placeholder")!==""){input.addClass("placeholder").val(input.attr("placeholder"))}input.focus(function(){if(input.val()==input.attr("placeholder")){input.val("")
}});input.blur(function(){if(input.val()===""||input.val()==input.attr("placeholder")){input.val(input.attr("placeholder"))}})})}};var lastPopedPopover;var handlePopovers=function(){$(".popovers").popover();$(document).on("click.bs.popover.data-api",function(e){if(lastPopedPopover){lastPopedPopover.popover("hide")}})};var handleScrollers=function(){App.initSlimScroll(".scroller")};var handleInitFullScreen=function(){var fullScreenClickCount=0;$(".fullscreen").bind("click",function(){if(fullScreenClickCount%2===0){handleFullScreen()}else{exitFullscreen()}fullScreenClickCount++})};return{init:function(){handleiCheck();handleBootstrapSwitch();handleScrollers();handleAlerts();handleDropdowns();handleTabs();handleTooltips();handlePopovers();handleAccordions();handleModals();handleBootstrapConfirmation();handleFixInputPlaceholderForIE();handleInitFullScreen()},initSlimScroll:function(el){$(el).each(function(){if($(this).attr("data-initialized")){return}var height;if($(this).attr("data-height")){height=$(this).attr("data-height")}else{height=$(this).css("height")}$(this).slimScroll({allowPageScroll:true,size:"7px",color:($(this).attr("data-handle-color")?$(this).attr("data-handle-color"):"#bbb"),wrapperClass:($(this).attr("data-wrapper-class")?$(this).attr("data-wrapper-class"):"slimScrollDiv"),railColor:($(this).attr("data-rail-color")?$(this).attr("data-rail-color"):"#eaeaea"),position:isRTL?"left":"right",height:height,alwaysVisible:($(this).attr("data-always-visible")=="1"?true:false),railVisible:($(this).attr("data-rail-visible")=="1"?true:false),disableFadeOut:true});$(this).attr("data-initialized","1")})},destroySlimScroll:function(el){$(el).each(function(){if($(this).attr("data-initialized")==="1"){$(this).removeAttr("data-initialized");$(this).removeAttr("style");var attrList={};if($(this).attr("data-handle-color")){attrList["data-handle-color"]=$(this).attr("data-handle-color")}if($(this).attr("data-wrapper-class")){attrList["data-wrapper-class"]=$(this).attr("data-wrapper-class")}if($(this).attr("data-rail-color")){attrList["data-rail-color"]=$(this).attr("data-rail-color")}if($(this).attr("data-always-visible")){attrList["data-always-visible"]=$(this).attr("data-always-visible")}if($(this).attr("data-rail-visible")){attrList["data-rail-visible"]=$(this).attr("data-rail-visible")}$(this).slimScroll({wrapperClass:($(this).attr("data-wrapper-class")?$(this).attr("data-wrapper-class"):"slimScrollDiv"),destroy:true});var the=$(this);$.each(attrList,function(key,value){the.attr(key,value)})}})},getIframeLayoutHeight:function(){return handleIframeLayoutHeight()},requestFullScreen:function(){return handleFullScreen()},handleIframeContent:function(){return handleIframeLayoutContent()},handleSidebarAjaxContent:function(){jQuery(".sidebar-menu").on("click"," li > a.ajaxify",function(e){e.preventDefault();var url=$(this).attr("href");var pageContentBody=$("#tab-page-content");App.startPageLoading({message:"加载中..."});$.get(url,{},function(res){pageContentBody.html(res);App.stopPageLoading()})})},fixIframeContent:function(){setInterval(function(){handleIframeLayoutContent()},200);return},blockUI:function(options){options=$.extend(true,{},options);var html="";if(options.animate){html='<div class="loading-message '+(options.boxed?"loading-message-boxed":"")+'">'+'<div class="block-spinner-bar"><div class="bounce1"></div><div class="bounce2"></div><div class="bounce3"></div></div>'+"</div>"}else{if(options.iconOnly){html='<div class="loading-message '+(options.boxed?"loading-message-boxed":"")+'"><img src="'+this.getGlobalImgPath()+'loading/loading-spinner-blue.gif" align=""></div>'}else{if(options.textOnly){html='<div class="loading-message '+(options.boxed?"loading-message-boxed":"")+'"><span>&nbsp;&nbsp;'+(options.message?options.message:"LOADING...")+"</span></div>"}else{html='<div class="loading-message '+(options.boxed?"loading-message-boxed":"")+'"><img src="'+this.getGlobalImgPath()+'loading/loading-spinner-blue.gif" align=""><span>&nbsp;&nbsp;'+(options.message?options.message:"LOADING...")+"</span></div>"}}}if(options.target){var el=$(options.target);if(el.height()<=($(window).height())){options.cenrerY=true}el.block({message:html,baseZ:options.zIndex?options.zIndex:1000,centerY:options.cenrerY!==undefined?options.cenrerY:false,css:{top:"10%",border:"0",padding:"0",backgroundColor:"none"},overlayCSS:{backgroundColor:options.overlayColor?options.overlayColor:"#555",opacity:options.boxed?0.05:0.1,cursor:"wait"}})}else{$.blockUI({message:html,baseZ:options.zIndex?options.zIndex:1000,css:{border:"0",padding:"0",backgroundColor:"none"},overlayCSS:{backgroundColor:options.overlayColor?options.overlayColor:"#555",opacity:options.boxed?0.05:0.1,cursor:"wait"}})}},unblockUI:function(target,title){if(target){$(target).unblock({onUnblock:function(){$(target).css("position","");$(target).css("zoom","")}})}else{$.unblockUI()}},startPageLoading:function(options){if(options&&options.animate){$(".page-spinner-bar").remove();$("body").append('<div class="page-spinner-bar"><div class="bounce1"></div><div class="bounce2"></div><div class="bounce3"></div></div>')
    }else{$(".page-loading").remove();$("body").append('<div class="page-loading"><img src="'+this.getGlobalImgPath()+'loading-spinner-blue.gif"/>&nbsp;&nbsp;<span>'+(options&&options.message?options.message:"Loading...")+"</span></div>")}},stopPageLoading:function(){$(".page-loading, .page-spinner-bar").remove()},getViewPort:function(){var e=window,a="inner";if(!("innerWidth" in window)){a="client";e=document.documentElement||document.body}return{width:e[a+"Width"],height:e[a+"Height"]}},getbasePath:function(){return basePath},setbasePath:function(path){basePath=path},setGlobalImgPath:function(path){imgPath=path},getGlobalImgPath:function(){return basePath+imgPath},setGlobalPluginsPath:function(path){pluginsPath=path},getGlobalPluginsPath:function(){return basePath+pluginsPath},getGlobalCssPath:function(){return basePath+cssPath}}}();jQuery(document).ready(function(){App.init()});(function(){function CustomEvent(event,params){params=params||{bubbles:false,cancelable:false,detail:undefined};var evt=document.createEvent("CustomEvent");evt.initCustomEvent(event,params.bubbles,params.cancelable,params.detail);return evt}CustomEvent.prototype=window.Event.prototype;window.CustomEvent=CustomEvent})();var addTabs=function(options){var url=window.location.pathname+"/../";options.url=url+options.url;var id="tab_"+options.id;var title="",content="";if(!$("#"+id)[0]){title='<a href="javascript:void(0);" id="tab_'+id+'"  data-id="'+id+'"  class="menu_tab" title='+options.title+">"+options.title;if(options.close){title+=' <i class="fa fa-remove page_tab_close" style="cursor: pointer;" data-id="'+id+'" onclick="closeTab(this)"></i>'}title+="</a>";var loadIframe="";if(options.content){content='<div role="tabpanel" class="tab-pane" id="'+id+'">'+options.content+"</div>"}else{App.blockUI({target:"#tab-content",boxed:true,message:"加载中......",animate:false});content='<div role="tabpanel" class="tab-pane" id="'+id+'" style="background: #F2F2F2;">';loadIframe="<iframe onload=\"javascript:App.unblockUI('#tab-content','"+options.title+'\');" src="'+options.url+'" width="100%" height="100%" frameborder="no" border="0" marginwidth="0" marginheight="0" scrolling="yes"  allowtransparency="yes" id="iframe_'+id+'" class="  tab_iframe"></iframe>';content+=loadIframe;content+="</div>"}$(".page-tabs-content").append(title);$("#tab-content").append(content)}$(".page-tabs-content > a.active").removeClass("active");$("#tab-content > .active").removeClass("active");$("#tab_"+id).addClass("active");scrollToTab($(".menu_tab.active"));$("#"+id).addClass("active")};var closeTab=function(item){var id=$(item).attr("data-id");if($(".page-tabs-content > a.active").attr("id")==="tab_"+id){var prev=$("#tab_"+id).prev();var prevIframe=$("#"+id).prev();setTimeout(function(){prev.addClass("active");prevIframe.addClass("active")},300)}$("#tab_"+id).remove();$("#"+id).remove()};var closeCurrentTab=function(){var currentTab=$(".page-tabs-content").find(".active").find(".fa-remove").parents("a");if(currentTab){closeTab(currentTab)}};var refreshTab=function(){var currentId=$(".page-tabs-content").find(".active").attr("data-id");var target=$("#iframe_"+currentId);var url=target.attr("src");target.attr("src",url)};var closeOtherTabs=function(isAll){if(isAll){$(".page-tabs-content").children("[data-id]").find(".fa-remove").parents("a").each(function(){$("#"+$(this).data("id")).remove();$(this).remove()});var firstChild=$(".page-tabs-content").children();if(firstChild){$("#"+firstChild.data("id")).addClass("active");firstChild.addClass("active")}}else{$(".page-tabs-content").children("[data-id]").find(".fa-remove").parents("a").not(".active").each(function(){$("#"+$(this).data("id")).remove();$(this).remove()})}};var calSumWidth=function(element){var width=0;$(element).each(function(){width+=$(this).outerWidth(true)});return width};var scrollTabRight=function(){var marginLeftVal=Math.abs(parseInt($(".page-tabs-content").css("margin-left")));var tabOuterWidth=calSumWidth($(".content-tabs").children().not(".menuTabs"));var visibleWidth=$(".content-tabs").outerWidth(true)-tabOuterWidth;var scrollVal=0;if($(".page-tabs-content").width()<visibleWidth){return false}else{var tabElement=$(".menu_tab:first");var offsetVal=0;while((offsetVal+$(tabElement).outerWidth(true))<=marginLeftVal){offsetVal+=$(tabElement).outerWidth(true);tabElement=$(tabElement).next()}offsetVal=0;while((offsetVal+$(tabElement).outerWidth(true))<(visibleWidth)&&tabElement.length>0){offsetVal+=$(tabElement).outerWidth(true);tabElement=$(tabElement).next()}scrollVal=calSumWidth($(tabElement).prevAll());if(scrollVal>0){$(".page-tabs-content").animate({marginLeft:0-scrollVal+"px"},"fast")}}};var scrollToTab=function(element){var marginLeftVal=calSumWidth($(element).prevAll()),marginRightVal=calSumWidth($(element).nextAll());var tabOuterWidth=calSumWidth($(".content-tabs").children().not(".menuTabs"));var visibleWidth=$(".content-tabs").outerWidth(true)-tabOuterWidth;var scrollVal=0;if($(".page-tabs-content").outerWidth()<visibleWidth){scrollVal=0
}else{if(marginRightVal<=(visibleWidth-$(element).outerWidth(true)-$(element).next().outerWidth(true))){if((visibleWidth-$(element).next().outerWidth(true))>marginRightVal){scrollVal=marginLeftVal;var tabElement=element;while((scrollVal-$(tabElement).outerWidth())>($(".page-tabs-content").outerWidth()-visibleWidth)){scrollVal-=$(tabElement).prev().outerWidth();tabElement=$(tabElement).prev()}}}else{if(marginLeftVal>(visibleWidth-$(element).outerWidth(true)-$(element).prev().outerWidth(true))){scrollVal=marginLeftVal-$(element).prev().outerWidth(true)}}}$(".page-tabs-content").animate({marginLeft:0-scrollVal+"px"},"fast")};var scrollTabLeft=function(){var marginLeftVal=Math.abs(parseInt($(".page-tabs-content").css("margin-left")));var tabOuterWidth=calSumWidth($(".content-tabs").children().not(".menuTabs"));var visibleWidth=$(".content-tabs").outerWidth(true)-tabOuterWidth;var scrollVal=0;if($(".page-tabs-content").width()<visibleWidth){return false}else{var tabElement=$(".menu_tab:first");var offsetVal=0;while((offsetVal+$(tabElement).outerWidth(true))<=marginLeftVal){offsetVal+=$(tabElement).outerWidth(true);tabElement=$(tabElement).next()}offsetVal=0;if(calSumWidth($(tabElement).prevAll())>visibleWidth){while((offsetVal+$(tabElement).outerWidth(true))<(visibleWidth)&&tabElement.length>0){offsetVal+=$(tabElement).outerWidth(true);tabElement=$(tabElement).prev()}scrollVal=calSumWidth($(tabElement).prevAll())}}$(".page-tabs-content").animate({marginLeft:0-scrollVal+"px"},"fast")};var activeTab=function(){var id=$(this).attr("data-id");$(".menu_tab").removeClass("active");$("#tab-content > .active").removeClass("active");$("#tab_"+id).addClass("active");$("#"+id).addClass("active");$("#iframe_"+id).animate({height:App.getIframeLayoutHeight()+1},500);$("#iframe_"+id).animate({height:App.getIframeLayoutHeight()-1},500);scrollToTab(this)};$(function(){$(".menuTabs").on("click",".menu_tab",activeTab)});$(function(){$(document).ajaxError(function(event,xhr,options,exc){if(xhr.status==="undefined"){return}switch(xhr.status){case 403:$.modal.alert("您没有访问权限！",modal_status.FAIL);break;case 404:$.modal.alert("您访问的资源不存在！",modal_status.FAIL);break;case 500:$.modal.alert("服务器开小差了~~,请您稍后重试！",modal_status.FAIL);break}})});$(function(){$.fn.sidebarMenu=function(options){init($(this),options.data,0);function init(target,data,level){$.each(data,function(i,item){var header=$('<li class="header"></li>');if(item.isHeader!=null&&item.isHeader===true){header.append(item.name);target.append(header);return}var li=$('<li class="treeview" data-level="'+level+'"></li>');var a;if(level>0){if(level==1){a=$('<a style="padding-left:'+(level*20)+'px"></a>')}if(level==2){a=$('<a style="padding-left:'+(level*5)+'px"></a>')}if(level==3){a=$('<a style="padding-left:'+(level)+'px"></a>')}}else{a=$("<a></a>")}var icon=$("<i></i>");icon.addClass(item.icon);var isOpen=item.isOpen;var text=$('<span class="title"></span>');text.addClass("menu-text").text(item.name);a.append(icon);a.append(text);a.addClass("nav-link");if(isOpen===true){li.addClass("active")}if(item.children&&item.children.length>0){var pullSpan=$('<span class="pull-right-container"></span>');var pullIcon=$('<i class="fa fa-angle-left pull-right"></i>');pullSpan.append(pullIcon);a.append(pullSpan);li.append(a);var menus=$("<ul></ul>");menus.addClass("treeview-menu");if(isOpen===true){menus.css("display","block");menus.addClass("menu-open")}else{menus.css("display","none")}init(menus,item.children,level+1);li.append(menus)}else{var href="addTabs({id:'"+item.id+"',title: '"+item.name+"',close: true,url: '"+item.url+"'});";a.attr("onclick",href);a.addClass("nav-link");var badge=$("<span></span>");if(item.tip!=null&&item.tip>0){badge.addClass("label").addClass("label-success").text(item.tip)}a.append(badge);li.append(a)}target.append(li)})}}});